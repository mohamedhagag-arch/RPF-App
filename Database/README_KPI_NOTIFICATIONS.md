# KPI Notifications Setup Guide
# ุฏููู ุฅุนุฏุงุฏ ุฅุดุนุงุฑุงุช KPI

## ุงูุฎุทูุงุช ุงููุทููุจุฉ

### ุงูุทุฑููุฉ ุงูุณุฑูุนุฉ (ูููุตู ุจูุง):
ูู ุจุชุดุบูู SQL script ูุงุญุฏ ููุท ูู Supabase SQL Editor:

```sql
-- ุณูุฑูุจุช ุดุงูู ูุงุญุฏ ูุฌููุน ุงูุฎุทูุงุช
Database/setup-kpi-notifications-complete.sql
```

ูุฐุง ุงูุณูุฑูุจุช ุณูููู ุจู:
- โ ุฅูุดุงุก ุงูุฌุฏุงูู (`kpi_notifications` ู `kpi_notification_settings`)
- โ ุฅูุดุงุก ุงูููุงุฑุณ (Indexes)
- โ ุชุนุทูู RLS
- โ ููุญ ุงูุตูุงุญูุงุช
- โ ุฅุถุงูุฉ ุงููุณุชุฎุฏููู ุชููุงุฆูุงู ูู Planning Department

### ุงูุทุฑููุฉ ุงููุฏููุฉ (ุฅุฐุง ููุช ุชูุถู ุฎุทูุงุช ูููุตูุฉ):

#### 1. ุฅูุดุงุก ุงูุฌุฏุงูู
```sql
Database/kpi-notifications-table.sql
```

#### 2. ุฅุตูุงุญ RLS Policies
```sql
Database/fix-kpi-notifications-rls.sql
```

### 3. ุงูุชุญูู ูู ุงูุฅุนุฏุงุฏ
ูู ุจุชุดุบูู SQL script ุงูุชุงูู ููุชุญูู ูู ุฃู ูู ุดูุก ูุนูู:

```sql
-- ุงูุชุญูู ูู ุงูุฅุนุฏุงุฏ
Database/check-kpi-notifications-setup.sql
```

### 4. ุฅุนุฏุงุฏ ุงููุณุชุฎุฏููู
ุงุฐูุจ ุฅูู **Settings > KPI Notification Settings** ูุงุฎุชุฑ ุงููุณุชุฎุฏููู ุงูุฐูู ูุฌุจ ุฃู ูุญุตููุง ุนูู ุงูุฅุดุนุงุฑุงุช.

**ุจุฏูู:** ุฅุฐุง ูู ุชูู ุจุฅุนุฏุงุฏ ุงููุณุชุฎุฏูููุ ุงููุธุงู ุณูุณุชุฎุฏู ุชููุงุฆูุงู:
- ุฌููุน ุงููุณุชุฎุฏููู ูู Planning Department
- ุฌููุน ุงููุณุชุฎุฏููู ูุน role = 'planner' ุฃู 'manager'

## ููู ูุนูู ุงููุธุงู

### ุนูุฏ ุฅูุดุงุก KPI ุฌุฏูุฏ:
1. ุนูุฏูุง ููุดุฆ Engineer KPI ุฌุฏูุฏ (Input Type = "Actual")
2. ูุชู ุฅุฑุณุงู ุฅุดุนุงุฑ ุชููุงุฆูุงู ูุฌููุน ุงููุณุชุฎุฏููู ุงููุญุฏุฏูู ูู Settings

### ููู KPIs ุงูููุฌูุฏุฉ (Need to Submit):
1. ุนูุฏ ูุชุญ ุงูุชุทุจููุ ุงููุธุงู ูุชุญูู ุชููุงุฆูุงู ูู KPIs ุงููุนููุฉ
2. ูุชู ุฅูุดุงุก ุฅุดุนุงุฑุงุช ููู KPIs ุงูุชู ุชุญุชุงุฌ ููููุงููุฉ
3. ูุชู ุชุญุฏูุซ ุงูุฅุดุนุงุฑุงุช ูู 30 ุซุงููุฉ

### ุนุฑุถ ุงูุฅุดุนุงุฑุงุช:
- **ุงููููุน:** ูู ุฃุนูู ุงูุตูุญุฉ (Top Bar) ุจุฌุงูุจ Theme Toggle
- **ุงูุฃููููุฉ:** Bell icon ูุน Badge ุฃุญูุฑ ูุธูุฑ ุนุฏุฏ ุงูุฅุดุนุงุฑุงุช ุบูุฑ ุงูููุฑูุกุฉ
- **ุนูุฏ ุงูููุฑ:** ููุชุญ Dropdown ูุนุฑุถ ุฌููุน ุงูุฅุดุนุงุฑุงุช

## ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: ุงูุฅุดุนุงุฑุงุช ูุง ุชุธูุฑ
**ุงูุญู:**
1. ุชุฃูุฏ ูู ุชุดุบูู SQL scripts ุฃุนูุงู
2. ุงูุชุญ Console ูู ุงููุชุตูุญ ูุชุญูู ูู ุงูุฃุฎุทุงุก
3. ุชุญูู ูู ุฃู ุงููุณุชุฎุฏููู ูุถุงููู ูู Settings
4. ุชุญูู ูู ุฃู ุงูุฌุฏุงูู ููุฌูุฏุฉ ุจุงุณุชุฎุฏุงู `check-kpi-notifications-setup.sql`

### ุงููุดููุฉ: "No recipients found"
**ุงูุญู:**
1. ุงุฐูุจ ุฅูู Settings > KPI Notification Settings
2. ุงุฎุชุฑ ุงููุณุชุฎุฏููู ุงูุฐูู ูุฌุจ ุฃู ูุญุตููุง ุนูู ุงูุฅุดุนุงุฑุงุช
3. ุงุญูุธ ุงูุฅุนุฏุงุฏุงุช

### ุงููุดููุฉ: "Table does not exist"
**ุงูุญู:**
1. ูู ุจุชุดุบูู `Database/setup-kpi-notifications-complete.sql` ูู Supabase (ุงูุทุฑููุฉ ุงูุฃุณูู)
2. ุฃู ูู ุจุชุดุบูู `Database/kpi-notifications-table.sql` ุซู `Database/fix-kpi-notifications-rls.sql`
3. ุชุฃูุฏ ูู ุฃู ุงูุฌุฏุงูู ุชู ุฅูุดุงุคูุง ุจูุฌุงุญ
4. ุงูุชุญ Console ูู ุงููุชุตูุญ (F12) ูุชุญูู ูู ุนุฏู ูุฌูุฏ ุฃุฎุทุงุก

### ุงููุดููุฉ: "Permission denied"
**ุงูุญู:**
1. ูู ุจุชุดุบูู `Database/fix-kpi-notifications-rls.sql`
2. ูุฐุง ุณูุนุทู RLS ูุคูุชุงู ูุถูุงู ุนูู ุงูุฅุดุนุงุฑุงุช

## ููุงุญุธุงุช ูููุฉ

- ุงูุฅุดุนุงุฑุงุช ูุชู ุชุญุฏูุซูุง ุชููุงุฆูุงู ูู 30 ุซุงููุฉ
- ุนูุฏ ูุชุญ Dropdown ุงูุฅุดุนุงุฑุงุชุ ูุชู ุงูุชุญูู ูู KPIs ุงููุนููุฉ ุชููุงุฆูุงู ูุฅูุดุงุก ุฅุดุนุงุฑุงุช ุฌุฏูุฏุฉ
- ููููู ุชุญุฏูุฏ ุฅุดุนุงุฑ ูููุฑูุก ุจุงูููุฑ ุนูู X
- ููููู ุชุญุฏูุฏ ุงููู ูููุฑูุก ุจุงุณุชุฎุฏุงู "Mark all as read"

## ุงุณุชูุดุงู ุงูุฃุฎุทุงุก ุงููุชูุฏู

### ุงูุชุญ Console ูู ุงููุชุตูุญ (F12)
ุณุชุฌุฏ ุฑุณุงุฆู ูุซู:
- `๐ Starting notifyPendingKPIs...` - ุจุฏุก ุงูุชุญูู
- `๐ Found X pending KPIs` - ุนุฏุฏ KPIs ุงููุนููุฉ
- `๐ฅ Found X recipients` - ุนุฏุฏ ุงููุณุชุฎุฏููู ุงูุฐูู ุณูุญุตููู ุนูู ุงูุฅุดุนุงุฑุงุช
- `โ Created X notifications` - ุนุฏุฏ ุงูุฅุดุนุงุฑุงุช ุงูููุดุฃุฉ
- `โ Error...` - ุฃู ุฃุฎุทุงุก

### ุฅุฐุง ุฑุฃูุช "No recipients found":
1. ุงุฐูุจ ุฅูู Settings > KPI Notification Settings
2. ุงุฎุชุฑ ุงููุณุชุฎุฏููู
3. ุงุญูุธ ุงูุฅุนุฏุงุฏุงุช
4. ุฃู ุชุฃูุฏ ูู ุฃู `setup-kpi-notifications-complete.sql` ุชู ุชุดุบููู (ุณูุถูู ุงููุณุชุฎุฏููู ุชููุงุฆูุงู)

